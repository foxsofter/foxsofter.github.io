<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Objective c动态添加属性 &#8211; 稻子</title>
<meta name="description" content="可能是Objective c动态添加属性最简单最好的方式了">
<meta name="keywords" content="objective c">

  

<!-- Twitter Cards -->
<meta name="twitter:title" content="Objective c动态添加属性">
<meta name="twitter:description" content="可能是Objective c动态添加属性最简单最好的方式了">
<meta name="twitter:site" content="@foxsofter">
<meta name="twitter:creator" content="@foxsofter">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://foxsofter.github.io/images/site-logo.png">

<!-- Open Graph -->
<meta property="og:locale" content="zh_CN">
<meta property="og:type" content="article">
<meta property="og:title" content="Objective c动态添加属性">
<meta property="og:description" content="可能是Objective c动态添加属性最简单最好的方式了">
<meta property="og:url" content="http://foxsofter.github.io/articles/objc-associatedobject/">
<meta property="og:site_name" content="稻子">





<link rel="canonical" href="http://foxsofter.github.io/articles/objc-associatedobject/">
<link href="http://foxsofter.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="稻子 Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://foxsofter.github.io/assets/css/main.css">
<!-- Webfonts -->
<script src="https://use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="http://foxsofter.github.io/assets/js/vendor/html5shiv.min.js"></script>
  <script src="http://foxsofter.github.io/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://foxsofter.github.io/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>


<!-- MathJax -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://foxsofter.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://foxsofter.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://foxsofter.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://foxsofter.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://foxsofter.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://foxsofter.github.io/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		        
		    
		    <li><a href="http://foxsofter.github.io/about/" >关于</a></li>
		  
		    
		        
		    
		    <li><a href="http://foxsofter.github.io/articles/" >博客</a></li>
		  
		    
		        
		    
		    <li><a href="http://foxsofter.github.io/life/" >生活</a></li>
		  
		    
		        
		    
		    <li><a href="http://foxsofter.github.io/search/" >搜索</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<header class="masthead">
	<div class="wrap">
      
  		<a href="http://foxsofter.github.io/" class="site-logo" rel="home" title="稻子"><img src="http://foxsofter.github.io/images/site-logo.png" width="200" height="200" alt="稻子 logo" class="animated fadeInDown"></a>
      
      <h1 class="site-title animated fadeIn"><a href="http://foxsofter.github.io/">稻子</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description"></h2>
	</div>
</header><!-- /.masthead -->

<div class="js-menu-screen menu-screen"></div>


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <span class="entry-tags"><a href="http://foxsofter.github.io/tags/#objective c" title="Pages tagged objective c">objective c</a></span>
        
          <h1 class="entry-title">Objective c动态添加属性</h1>
        
      </header>
      <footer class="entry-meta">
        
          
        
          <img src="http://foxsofter.github.io/images/bio-photo-2.jpg" class="bio-photo" alt="稻子 bio photo"></a>
        
        <span class="author vcard">By <span class="fn">稻子</span></span>
        <span class="entry-date date published"><time datetime="2015-10-11T00:00:00+08:00"><i class="fa fa-calendar-o"></i> October 11, 2015</time></span>
        <span class="entry-date date modified"><time datetime="2013-05-31"><i class="fa fa-pencil"></i> May 31, 2013</time></span>
        
        <span class="social-share-twitter">
  <a href="https://twitter.com/intent/tweet?hashtags=objectivec&amp;text=Objective%20c动态添加属性&amp;url=http://foxsofter.github.io/articles/objc-associatedobject/&amp;via=foxsofter" title="Share on Twitter" itemprop="Twitter"><i class="fa fa-twitter-square"></i> Tweet</a>
</span>
<span class="social-share-facebook">
  <a href="https://www.facebook.com/sharer/sharer.php?u=http://foxsofter.github.io/articles/objc-associatedobject/" title="Share on Facebook" itemprop="Facebook"><i class="fa fa-facebook-square"></i> Like</a>
</span>
<span class="social-share-googleplus">
  <a href="https://plus.google.com/share?url=http://foxsofter.github.io/articles/objc-associatedobject/" title="Share on Google Plus" itemprop="GooglePlus"><i class="fa fa-google-plus-square"></i> +1</a>
</span>
<!-- /.social-share -->
        
      </footer>
      <div class="entry-content">
        <p>上代码吧</p>

<pre><code>
//
//  NSObject+AssociatedObject.h
//  FXCategories
//
//  Created by fox softer on 15/2/23.
//  Copyright (c) 2015年 foxsofter. All rights reserved.
//

#import &lt;Foundation/Foundation.h&gt;

/**
 *  @author foxsofter, 15-02-23 21:02:44
 *
 *  @brief  添加属性到对象
 */
 @implementation NSObject (AssociatedObject)

 - (id)object:(SEL)key {
   return objc_getAssociatedObject(self, key);
 }

 - (void)setAssignObject:(id)object withKey:(SEL)key {
   objc_setAssociatedObject(self, key, object, OBJC_ASSOCIATION_ASSIGN);
 }

 - (void)setRetainNonatomicObject:(id)object withKey:(SEL)key {
   objc_setAssociatedObject(self, key, object, OBJC_ASSOCIATION_RETAIN_NONATOMIC);
 }

 - (void)setCopyNonatomicObject:(id)object withKey:(SEL)key {
   objc_setAssociatedObject(self, key, object, OBJC_ASSOCIATION_COPY_NONATOMIC);
 }

 - (void)setRetainObject:(id)object withKey:(SEL)key {
   objc_setAssociatedObject(self, key, object, OBJC_ASSOCIATION_COPY_NONATOMIC);
 }

 - (void)setCopyObject:(id)object withKey:(SEL)key {
   objc_setAssociatedObject(self, key, object, OBJC_ASSOCIATION_COPY_NONATOMIC);
 }

 @end
</code>

使用例子

<pre><code>
//
//  UIControl+Block.m
//  WisdomAir
//
//  Created by fox softer on 15/2/23.
//  Copyright (c) 2015年 foxsofter. All rights reserved.
//


@interface UIControl (Block)

- (void)touchDown:(void (^)(void))eventBlock;
- (void)touchDownRepeat:(void (^)(void))eventBlock;
- (void)touchDragInside:(void (^)(void))eventBlock;
- (void)touchDragOutside:(void (^)(void))eventBlock;
- (void)touchDragEnter:(void (^)(void))eventBlock;
- (void)touchDragExit:(void (^)(void))eventBlock;
- (void)touchUpInside:(void (^)(void))eventBlock;
- (void)touchUpOutside:(void (^)(void))eventBlock;
- (void)touchCancel:(void (^)(void))eventBlock;
- (void)valueChanged:(void (^)(void))eventBlock;
- (void)editingDidBegin:(void (^)(void))eventBlock;
- (void)editingChanged:(void (^)(void))eventBlock;
- (void)editingDidEnd:(void (^)(void))eventBlock;
- (void)editingDidEndOnExit:(void (^)(void))eventBlock;

@end

#import "UIControl+Block.h"

// UIControlEventTouchDown           = 1 &lt;&lt;  0,      // on all touch downs
// UIControlEventTouchDownRepeat     = 1 &lt;&lt;  1,      // on multiple touchdowns (tap count &gt; 1)
// UIControlEventTouchDragInside     = 1 &lt;&lt;  2,
// UIControlEventTouchDragOutside    = 1 &lt;&lt;  3,
// UIControlEventTouchDragEnter      = 1 &lt;&lt;  4,
// UIControlEventTouchDragExit       = 1 &lt;&lt;  5,
// UIControlEventTouchUpInside       = 1 &lt;&lt;  6,
// UIControlEventTouchUpOutside      = 1 &lt;&lt;  7,
// UIControlEventTouchCancel         = 1 &lt;&lt;  8,
//
// UIControlEventValueChanged        = 1 &lt;&lt; 12,     // sliders, etc.
//
// UIControlEventEditingDidBegin     = 1 &lt;&lt; 16,     // UITextField
// UIControlEventEditingChanged      = 1 &lt;&lt; 17,
// UIControlEventEditingDidEnd       = 1 &lt;&lt; 18,
// UIControlEventEditingDidEndOnExit = 1 &lt;&lt; 19,     // 'return key' ending editing
//
// UIControlEventAllTouchEvents      = 0x00000FFF,  // for touch events
// UIControlEventAllEditingEvents    = 0x000F0000,  // for UITextField
// UIControlEventApplicationReserved = 0x0F000000,  // range available for application use
// UIControlEventSystemReserved      = 0xF0000000,  // range reserved for internal framework use
// UIControlEventAllEvents           = 0xFFFFFFFF

#define UICONTROLEVENT(methodName, eventName)                                                      \
  -(void)methodName : (void (^)(void))eventBlock {                                                 \
    [self setCopyNonatomicObject:eventBlock withKey:@selector(methodName:)];                       \
    [self addTarget:self                                                                           \
                  action:@selector(methodName##Action:)                                            \
        forControlEvents:UIControlEvent##eventName];                                               \
  }                                                                                                \
  -(void)methodName##Action : (id)sender {                                                         \
    void (^block)() = [self object:@selector(methodName:)];                                        \
    if (block) {                                                                                   \
      block();                                                                                     \
    }                                                                                              \
  }

@interface UIControl ()

@end

@implementation UIControl (Block)

UICONTROLEVENT(touchDown, TouchDown)
UICONTROLEVENT(touchDownRepeat, TouchDownRepeat)
UICONTROLEVENT(touchDragInside, TouchDragInside)
UICONTROLEVENT(touchDragOutside, TouchDragOutside)
UICONTROLEVENT(touchDragEnter, TouchDragEnter)
UICONTROLEVENT(touchDragExit, TouchDragExit)
UICONTROLEVENT(touchUpInside, TouchUpInside)
UICONTROLEVENT(touchUpOutside, TouchUpOutside)
UICONTROLEVENT(touchCancel, TouchCancel)
UICONTROLEVENT(valueChanged, ValueChanged)
UICONTROLEVENT(editingDidBegin, EditingDidBegin)
UICONTROLEVENT(editingChanged, EditingChanged)
UICONTROLEVENT(editingDidEnd, EditingDidEnd)
UICONTROLEVENT(editingDidEndOnExit, EditingDidEndOnExit)

@end
</code>
</pre></pre>

        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
      
        <a href="http://foxsofter.github.io/life/begin/" class="btn" title="今天开始写博客">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<span>&copy; 2015 稻子. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/so-simple/" rel="nofollow">So Simple Theme</a>.</span>
<div class="social-icons">
	<a href="https://twitter.com/foxsofter" title="稻子 on Twitter" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
	
	
	
	
	
	
	<a href="https://github.com/foxsofter" title="稻子 on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
	
  
	
  <a href="http://foxsofter.github.io/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script type="text/javascript">
  var BASE_URL = 'http://foxsofter.github.io';
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://foxsofter.github.io/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://foxsofter.github.io/assets/js/scripts.min.js"></script>




</body>
</html>
